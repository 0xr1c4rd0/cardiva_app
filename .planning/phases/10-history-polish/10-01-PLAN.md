# Plan 10-01: Search, Sort & Pagination for RFPs Page

## Overview
Enhance the RFPs page with search, sort, and pagination capabilities matching the inventory page patterns.

## Wave
Wave 1 - Core Enhancement

## Tasks

### Task 1: Update RFPs page server component
**File**: `src/app/(dashboard)/rfps/page.tsx`

- Accept searchParams for: `page`, `pageSize`, `search`, `sortBy`, `sortOrder`
- Build Supabase query with search filter on `file_name` using `ilike`
- Apply sorting (filename or created_at)
- Apply pagination with count using `.select('*', { count: 'exact' })`
- Pass pagination data to client component

### Task 2: Create RFPListToolbar component
**File**: `src/app/(dashboard)/rfps/components/rfp-list-toolbar.tsx`

- Search input with debounced search (300ms) - same pattern as inventory TableToolbar
- Sort dropdown with options:
  - "Nome (A-Z)" → sortBy: file_name, sortOrder: asc
  - "Nome (Z-A)" → sortBy: file_name, sortOrder: desc
  - "Data (Recente)" → sortBy: created_at, sortOrder: desc
  - "Data (Antigo)" → sortBy: created_at, sortOrder: asc
- Loading indicator during transitions
- Use `use-debounce` package (already installed)

```tsx
interface RFPListToolbarProps {
  search: string
  onSearchChange: (value: string) => void
  sortBy: 'file_name' | 'created_at'
  sortOrder: 'asc' | 'desc'
  onSortChange: (sortBy: string, sortOrder: string) => void
  isPending: boolean
}
```

### Task 3: Create RFPListPagination component
**File**: `src/app/(dashboard)/rfps/components/rfp-list-pagination.tsx`

- Simple pagination controls matching inventory DataTablePagination
- "A mostrar X de Y concursos"
- Page size selector (10, 25, 50)
- Previous/Next buttons with disabled states

```tsx
interface RFPListPaginationProps {
  page: number
  pageSize: number
  totalCount: number
  onPageChange: (page: number) => void
  onPageSizeChange: (pageSize: number) => void
  isPending: boolean
}
```

### Task 4: Update RFPJobsList component
**File**: `src/app/(dashboard)/rfps/components/rfp-jobs-list.tsx`

- Accept `totalCount` and pagination props from parent
- Use URL state for search/sort/pagination via props (controlled component)
- Integrate toolbar at top
- Integrate pagination at bottom
- Keep real-time update logic for activeJob/lastCompletedJob

### Task 5: Update rfp-page-content.tsx
**File**: `src/app/(dashboard)/rfps/components/rfp-page-content.tsx`

- Accept new props: totalCount, page, pageSize, search, sortBy, sortOrder
- Set up URL state with nuqs hooks
- Handle state changes with useTransition for isPending
- Pass handlers to RFPJobsList

## URL State Parameters
```typescript
interface RFPListState {
  page: number       // default: 1
  pageSize: number   // default: 25, options: [10, 25, 50]
  search: string     // default: ''
  sortBy: 'file_name' | 'created_at'  // default: 'created_at'
  sortOrder: 'asc' | 'desc'           // default: 'desc'
}
```

## Verification
1. Navigate to `/rfps` → Jobs list loads with pagination
2. Type in search → List filters by filename with 300ms debounce
3. Clear search → All jobs return
4. Change sort to "Nome (A-Z)" → Jobs reorder alphabetically
5. Change sort to "Data (Antigo)" → Oldest jobs first
6. Click next page → Page 2 loads, URL updates
7. Change page size to 10 → Fewer items shown
8. Refresh page → State preserved from URL

## Dependencies
- `use-debounce` - Already installed
- `nuqs` - Already installed
- Existing inventory patterns to follow
